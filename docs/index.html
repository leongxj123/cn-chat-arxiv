<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>arXiv è®¡ç®—æœºç§‘å­¦è®ºæ–‡ RSS é˜…è¯»å™¨</title>
    <style>
        :root {
            --bg-color: #f4f4f4;
            --text-color: #333333;
            --link-color: #0066cc;
            --button-bg: #4CAF50;
            --button-text: #ffffff;
            --card-bg: #ffffff;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        #controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        #controls > * {
            margin: 5px;
        }
        select, input[type="text"], input[type="number"], button {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        button {
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #45a049;
        }
        #feed-list {
            list-style-type: none;
            padding: 0;
        }
        .feed-item {
            background-color: var(--card-bg);
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .feed-item:hover {
            transform: translateY(-5px);
        }
        .feed-item h2 {
            margin-top: 0;
            color: #2c3e50;
        }
        .feed-item a {
            color: var(--link-color);
            text-decoration: none;
        }
        .feed-item a:hover {
            text-decoration: underline;
        }
        .highlight {
            background-color: yellow;
            font-weight: bold;
        }
        #pagination, #page-numbers {
            margin-top: 20px;
            text-align: center;
        }
        #pagination button, #page-numbers button {
            margin: 0 5px;
            padding: 10px 15px;
        }
        .loading {
            text-align: center;
            font-style: italic;
            color: #666;
        }
        #dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px;
            background-color: #333;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        .dark-mode {
            --bg-color: #2c3e50;
            --text-color: #ecf0f1;
            --link-color: #3498db;
            --button-bg: #2980b9;
            --button-text: #ffffff;
            --card-bg: #34495e;
        }
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            #controls {
                flex-direction: column;
            }
            #controls > * {
                width: 100%;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <h1>arXiv è®¡ç®—æœºç§‘å­¦è®ºæ–‡ RSS é˜…è¯»å™¨</h1>
    <button id="dark-mode-toggle">ğŸŒ“</button>
    <div id="controls">
        <select id="category-select">
            <option value="cs.AI">AI: äººå·¥æ™ºèƒ½</option>
            <option value="cs.AR">AR: ç¡¬ä»¶æ¶æ„</option>
            <option value="cs.CC">CC: è®¡ç®—å¤æ‚æ€§</option>
            <option value="cs.CE">CE: è®¡ç®—å·¥ç¨‹ã€é‡‘èå’Œç§‘å­¦</option>
            <option value="cs.CG">CG: è®¡ç®—å‡ ä½•</option>
            <option value="cs.CL">CL: è®¡ç®—ä¸è¯­è¨€</option>
            <option value="cs.CR">CR: å¯†ç å­¦ä¸å®‰å…¨</option>
            <option value="cs.CV">CV: è®¡ç®—æœºè§†è§‰ä¸æ¨¡å¼è¯†åˆ«</option>
            <option value="cs.CY">CY: æ§åˆ¶ç†è®º</option>
            <option value="cs.DB">DB: æ•°æ®åº“</option>
            <option value="cs.DC">DC: åˆ†å¸ƒå¼ã€å¹¶è¡Œå’Œé›†ç¾¤è®¡ç®—</option>
            <option value="cs.DL">DL: æ•°å­—å›¾ä¹¦é¦†</option>
            <option value="cs.DM">DM: ç¦»æ•£æ•°å­¦</option>
            <option value="cs.DS">DS: æ•°æ®ç»“æ„ä¸ç®—æ³•</option>
            <option value="cs.ET">ET: æ–°å…´æŠ€æœ¯</option>
            <option value="cs.FL">FL: å½¢å¼è¯­è¨€ä¸è‡ªåŠ¨æœºç†è®º</option>
            <option value="cs.GL">GL: é€šç”¨æ–‡çŒ®</option>
            <option value="cs.GR">GR: å›¾å½¢å­¦</option>
            <option value="cs.GT">GT: è®¡ç®—æœºç§‘å­¦ä¸åšå¼ˆè®º</option>
            <option value="cs.HC">HC: äººæœºäº¤äº’</option>
            <option value="cs.IR">IR: ä¿¡æ¯æ£€ç´¢</option>
            <option value="cs.IT">IT: ä¿¡æ¯ç†è®º</option>
            <option value="cs.LG">LG: æœºå™¨å­¦ä¹ </option>
            <option value="cs.LO">LO: è®¡ç®—æœºç§‘å­¦ä¸­çš„é€»è¾‘</option>
            <option value="cs.MA">MA: å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ</option>
            <option value="cs.MM">MM: å¤šåª’ä½“</option>
            <option value="cs.MS">MS: æ•°å­¦è½¯ä»¶</option>
            <option value="cs.NA">NA: æ•°å€¼åˆ†æ</option>
            <option value="cs.NE">NE: ç¥ç»å’Œè¿›åŒ–è®¡ç®—</option>
            <option value="cs.NI">NI: ç½‘ç»œå’Œäº’è”ç½‘æ¶æ„</option>
            <option value="cs.OH">OH: å…¶ä»–è®¡ç®—æœºç§‘å­¦</option>
            <option value="cs.OS">OS: æ“ä½œç³»ç»Ÿ</option>
            <option value="cs.PF">PF: æ€§èƒ½</option>
            <option value="cs.PL">PL: ç¼–ç¨‹è¯­è¨€</option>
            <option value="cs.RO">RO: æœºå™¨äººå­¦</option>
            <option value="cs.SC">SC: ç¬¦å·è®¡ç®—</option>
            <option value="cs.SD">SD: å£°éŸ³</option>
            <option value="cs.SE">SE: è½¯ä»¶å·¥ç¨‹</option>
            <option value="cs.SI">SI: ç¤¾ä¼šå’Œä¿¡æ¯ç½‘ç»œ</option>
            <option value="cs.SY">SY: ç³»ç»Ÿä¸æ§åˆ¶</option>
            <option value="econ">econ: ç»æµå­¦</option>
            <option value="q-fin">q-fin: é‡åŒ–é‡‘èå­¦</option>
            <option value="q-bio">q-bio: å®šé‡ç”Ÿç‰©å­¦</option>
            <option value="math.ST">math.ST: ç»Ÿè®¡ç†è®º</option>
            <option value="physics.data-an">æ•°æ®åˆ†æã€ ç»Ÿè®¡å’Œæ¦‚ç‡</option>
            <option value="physics.soc-ph">ç‰©ç†å­¦ä¸ç¤¾ä¼š</option>
            <option value="q-bio.BM">ç”Ÿç‰©åˆ†å­</option>
            <option value="q-fin.RM">é£é™©ç®¡ç†</option>
            <option value="stat.AP">åº”ç”¨ç»Ÿè®¡</option>
            <option value="stat.ME">ç»Ÿè®¡æ–¹æ³•è®º</option>
            <option value="stat.ML">(ç»Ÿè®¡)æœºå™¨å­¦ä¹ </option>
        </select>
        <select id="sort-select">
            <option value="date">æŒ‰æ—¥æœŸæ’åº</option>
            <option value="relevance">æŒ‰ç›¸å…³æ€§æ’åº</option>
        </select>
        <select id="items-per-page">
            <option value="5">æ¯é¡µ 5 æ¡</option>
            <option value="10" selected>æ¯é¡µ 10 æ¡</option>
            <option value="20">æ¯é¡µ 20 æ¡</option>
            <option value="50">æ¯é¡µ 50 æ¡</option>
        </select>
        <div>
            <input type="checkbox" id="use-proxy" name="use-proxy">
            <label for="use-proxy">ä½¿ç”¨ä»£ç†</label>
        </div>
        <input type="text" id="search-input" placeholder="æœç´¢è®ºæ–‡...">
        <button onclick="loadFeed(true)">åŠ è½½æœ€æ–°è®ºæ–‡</button>
    </div>
    <ul id="feed-list"></ul>
    <div id="pagination"></div>
    <div id="page-numbers"></div>
    <div id="jump-container" style="text-align: center; margin-top: 20px;">
        <input type="number" id="page-jump" placeholder="è·³è½¬åˆ°é¡µæ•°" min="1" style="width: 100px;">
        <button onclick="jumpToPage()">è·³è½¬</button>
    </div>

    <script>
        let allItems = [];
        let currentPage = 1;
        let itemsPerPage = 10;
        let searchTerm = '';
        let currentCategory = '';
        const proxyUrl = 'https://api.allorigins.win/raw?url=';

        function loadFeed(forceRefresh = false) {
            currentCategory = document.getElementById('category-select').value;
            const useProxy = document.getElementById('use-proxy').checked;
            let feedUrl = `https://github.com/leongxj123/cn-chat-arxiv/${currentCategory}.xml`;
            
            if (useProxy) {
                feedUrl = proxyUrl + encodeURIComponent(feedUrl);
            }

            const feedList = document.getElementById('feed-list');
            feedList.innerHTML = '<div class="loading">åŠ è½½ä¸­...</div>';

            const cachedData = localStorage.getItem(currentCategory);
            if (!forceRefresh && cachedData) {
                const parsedData = JSON.parse(cachedData);
                if (new Date().getTime() - parsedData.timestamp < 3600000) {
                    allItems = parsedData.items;
                    currentPage = 1;
                    displayPage();
                    return;
                }
            }

            fetch(feedUrl)
                .then(response => response.text())
                .then(str => new window.DOMParser().parseFromString(str, "text/xml"))
                .then(data => {
                    allItems = Array.from(data.querySelectorAll('item')).map(item => ({
                        title: item.querySelector('title').textContent,
                        link: item.querySelector('link').textContent,
                        description: item.querySelector('description').textContent
                    }));
                    localStorage.setItem(currentCategory, JSON.stringify({
                        timestamp: new Date().getTime(),
                        items: allItems
                    }));
                    currentPage = 1;
                    displayPage();
                })
                .catch(error => {
                    feedList.innerHTML = 'åŠ è½½å¤±è´¥ã€‚è¯·ç¨åå†è¯•ã€‚';
                    console.error('Error:', error);
                });
        }

        function displayPage() {
            const feedList = document.getElementById('feed-list');
            feedList.innerHTML = '';

            const keywords = searchTerm.toLowerCase().split(' ').filter(kw => kw.trim().length > 0);
            const filteredItems = keywords.length
                ? allItems.filter(item => 
                    keywords.every(kw => item.title.toLowerCase().includes(kw) || item.description.toLowerCase().includes(kw))
                  )
                : allItems;

            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageItems = filteredItems.slice(startIndex, endIndex);

            pageItems.forEach((item, index) => {
                const highlightedTitle = highlightKeywords(item.title, keywords);
                const highlightedDescription = highlightKeywords(item.description, keywords);

                const li = document.createElement('li');
                li.className = 'feed-item';
                li.innerHTML = `
                    <h2>${startIndex + index + 1}. <a href="${item.link}" target="_blank">${highlightedTitle}</a></h2>
                    <p>${highlightedDescription}</p>
                `;
                feedList.appendChild(li);
            });

            updatePagination(filteredItems.length);
        }

        function highlightKeywords(text, keywords) {
            if (!keywords.length) return text;
            let highlightedText = text;
            keywords.forEach(kw => {
                const regex = new RegExp(`(${kw})`, 'gi');
                highlightedText = highlightedText.replace(regex, '<span class="highlight">\$1</span>');
            });
            return highlightedText;
        }

        function updatePagination(totalItems) {
            const paginationDiv = document.getElementById('pagination');
            const pageNumbersDiv = document.getElementById('page-numbers');
            const totalPages = Math.ceil(totalItems / itemsPerPage);

            let paginationHTML = '';
            if (currentPage > 1) {
                paginationHTML += `<button onclick="changePage(${currentPage - 1})">ä¸Šä¸€é¡µ</button>`;
            }
            paginationHTML += `<span>ç¬¬ ${currentPage} é¡µï¼Œå…± ${totalPages} é¡µ</span>`;
            if (currentPage < totalPages) {
                paginationHTML += `<button onclick="changePage(${currentPage + 1})">ä¸‹ä¸€é¡µ</button>`;
            }

            paginationDiv.innerHTML = paginationHTML;
            document.getElementById('page-jump').max = totalPages;

            let pageNumbersHTML = '';
            const pageRange = 2;
            let startPage = Math.max(1, currentPage - pageRange);
            let endPage = Math.min(totalPages, currentPage + pageRange);

            if (startPage > 1) {
                pageNumbersHTML += `<button onclick="changePage(1)">1</button>`;
                if (startPage > 2) {
                    pageNumbersHTML += '<span>...</span>';
                }
            }

            for (let i = startPage; i <= endPage; i++) {
                if (i === currentPage) {
                    pageNumbersHTML += `<button disabled>${i}</button>`;
                } else {
                    pageNumbersHTML += `<button onclick="changePage(${i})">${i}</button>`;
                }
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pageNumbersHTML += '<span>...</span>';
                }
                pageNumbersHTML += `<button onclick="changePage(${totalPages})">${totalPages}</button>`;
            }

            pageNumbersDiv.innerHTML = pageNumbersHTML;
        }

        function changePage(newPage) {
            currentPage = newPage;
            displayPage();
        }

        function jumpToPage() {
            const pageNumber = parseInt(document.getElementById('page-jump').value);
            if (pageNumber && pageNumber > 0 && pageNumber <= Math.ceil(allItems.length / itemsPerPage)) {
                currentPage = pageNumber;
                displayPage();
            } else {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é¡µç ');
            }
        }

        document.getElementById('items-per-page').addEventListener('change', function() {
            itemsPerPage = parseInt(this.value);
            currentPage = 1;
            displayPage();
        });

        document.getElementById('search-input').addEventListener('input', function() {
            searchTerm = this.value;
            currentPage = 1;
            displayPage();
        });

        document.getElementById('dark-mode-toggle').addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
        });

        document.getElementById('category-select').addEventListener('change', function() {
            localStorage.setItem('lastCategory', this.value);
            loadFeed(true);
        });

        document.getElementById('items-per-page').addEventListener('change', function() {
            localStorage.setItem('lastItemsPerPage', this.value);
        });

        document.getElementById('use-proxy').addEventListener('change', function() {
            localStorage.setItem('lastUseProxy', this.checked);
        });

        window.addEventListener('load', function() {
            const lastCategory = localStorage.getItem('lastCategory');
            const lastItemsPerPage = localStorage.getItem('lastItemsPerPage');
            const lastUseProxy = localStorage.getItem('lastUseProxy');
            if (lastCategory) {
                document.getElementById('category-select').value = lastCategory;
            }
            if (lastItemsPerPage) {
                document.getElementById('items-per-page').value = lastItemsPerPage;
                itemsPerPage = parseInt(lastItemsPerPage);
            }
            if (lastUseProxy) {
                document.getElementById('use-proxy').checked = JSON.parse(lastUseProxy);
            }
            loadFeed();
        });
    </script>
</body>
</html>
